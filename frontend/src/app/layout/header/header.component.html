<header>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container justify-content-center">
            <a class="navbar-brand me-auto" [routerLink]="['/home']">
                <img src="https://github.com/HNam1010/Myproject/raw/main/logo_shop.jpg"  alt="Hoàng Nam Shop" height="50">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" [routerLink]="['/home']" routerLinkActive="active-link"
                            [routerLinkActiveOptions]="{ exact: true }">
                            Trang chủ
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" [routerLink]="['/cart']" routerLinkActive="active-link" title="Giỏ hàng">
                            <i class="fa-solid fa-cart-shopping position-relative">

                                <!-- sử dụng pipe async -->
                                <span *ngIf="((cartService.distinctItemCount$ | async) ?? 0) > 0"
                                    class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger cart-count">
                                    {{ (cartService.distinctItemCount$ | async) ?? 0 }}
                                    <span class="visually-hidden">sản phẩm trong giỏ</span>
                                </span>


                            </i>
                            <span class="d-lg-none ms-1">Giỏ hàng</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" [routerLink]="['/inforshop']" routerLinkActive="active-link">
                            Thông tin cửa hàng
                        </a>
                    </li>

                    <!-- Nếu chưa đăng nhập -->
                    <!-- Sử dụng isLoggedIn$ với async pipe -->
                    <li *ngIf="!(authService.isLoggedIn$ | async)" class="nav-item">
                        <a class="nav-link" [routerLink]="['/login']" routerLinkActive="active-link">
                            Đăng Nhập
                        </a>
                    </li>
                    <li *ngIf="!(authService.isLoggedIn$ | async)" class="nav-item">
                        <a class="nav-link" [routerLink]="['/register']" routerLinkActive="active-link">
                            Đăng Ký
                        </a>
                    </li>

                    <!-- Nếu đã đăng nhập -->
                    <!-- Sử dụng isLoggedIn$ với async pipe -->
                    <li *ngIf="authService.isLoggedIn$ | async" class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownUser" role="button"
                            aria-expanded="false" (click)="toggleDropdown(); $event.preventDefault()">
                            <i class="fas fa-user me-1"></i>
                            <!-- Sử dụng currentUser$ với async pipe để lấy username -->
                            {{ (authService.currentUser$ | async)?.username || 'Tài khoản' }}
                            <!-- Sử dụng isAdmin$ với async pipe để hiển thị icon admin -->
                            <i *ngIf="authService.isAdmin$ | async" class="fas fa-shield-alt ms-1 text-warning"
                                title="Admin"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownUser"
                            [class.show]="isDropdownOpen">
                            <li>
                                <a class="dropdown-item" [routerLink]="['/user-profile']"
                                    (click)="isDropdownOpen = false">Thông tin tài khoản</a>
                            </li>

                            <!-- Các mục chỉ dành cho Admin -->
                            <li *ngIf="authService.isAdmin$ | async">
                                <a class="dropdown-item" [routerLink]="['/manager/managershop-home']"
                                    (click)="isDropdownOpen = false">
                                    <i class="fas fa-tachometer-alt fa-fw me-2"></i> Trang chủ Quản lý
                                </a>
                            </li>

                            <!-- Chỉ hiện nếu đã đăng nhập -->
                            <li>
                                <a class="dropdown-item" [routerLink]="['/order-history']"
                                    (click)="isDropdownOpen = false">
                                    <i class="fas fa-history fa-fw me-2"></i> Xem lịch sử đặt hàng
                                </a>
                            </li>

                            <li>
                                <a class="dropdown-item" href="javascript:void(0)"
                                    (click)="logout(); isDropdownOpen = false;">
                                    <i class="fas fa-sign-out-alt fa-fw me-2"></i> Đăng xuất
                                </a>
                            </li>
                        </ul>
                    </li>

                </ul>
            </div>
        </div>
    </nav>
</header>